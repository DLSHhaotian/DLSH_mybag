// Data: Ravn JÃ¸rgensen, Anders and Fuglsang Nielsen, Bjarke (2012)

#include "Drag.h"

Drag::Drag()
  : Cd{0.366667, 0.366713, 0.366849, 0.367073, 0.367383, 0.367778, 0.368255, 0.368813, 0.369450, 0.370165, 0.370955, 0.371818, 0.372753, 0.373759, 0.374832, 0.375972, 0.377176, 0.378444, 0.379772, 0.381159, 0.382604, 0.384104, 0.385658, 0.387264, 0.388920, 0.390625, 0.392376, 0.394171, 0.396010, 0.397890, 0.399809, 0.401766, 0.403758, 0.405784, 0.407843, 0.409931, 0.412049, 0.414192, 0.416361, 0.418553, 0.420766, 0.422999, 0.425249, 0.427515, 0.429795, 0.432087, 0.434390, 0.436702, 0.439020, 0.441343, 0.443670, 0.445998, 0.448326, 0.450651, 0.452972, 0.455288, 0.457596, 0.459895, 0.462182, 0.464457, 0.466716, 0.468959, 0.471184, 0.473388, 0.475570, 0.477729, 0.479861, 0.481967, 0.484043, 0.486088, 0.488100, 0.490077, 0.492018, 0.493921, 0.495784, 0.497605, 0.499382, 0.501113, 0.502797, 0.504433, 0.506017, 0.507548, 0.509025, 0.510446, 0.511808, 0.513111, 0.514352, 0.515529, 0.516641, 0.517686, 0.518662, 0.519567, 0.520399, 0.521158, 0.521840, 0.522444, 0.522968, 0.523410, 0.523770, 0.524044, 0.524231, 0.524329, 0.524336, 0.524251, 0.524072, 0.523797, 0.523424, 0.522952, 0.522378, 0.521700, 0.520918, 0.520029, 0.519031, 0.517923, 0.516702, 0.515368, 0.513917, 0.512349, 0.510661, 0.508852, 0.506920, 0.504863, 0.502679, 0.500367, 0.497925, 0.495350, 0.492641, 0.489797, 0.486815, 0.483694, 0.480432, 0.477026, 0.473476, 0.469780, 0.465935, 0.461939, 0.457792, 0.453491, 0.449035, 0.444421, 0.439648, 0.434714, 0.429617, 0.424356, 0.418928, 0.413332, 0.407565, 0.401627, 0.395516, 0.389229, 0.382765, 0.376121, 0.369297, 0.362290, 0.355099, 0.347722, 0.340156, 0.332401, 0.324453, 0.316313, 0.307977, 0.299444, 0.290712, 0.281779, 0.272644, 0.263305, 0.253795, 0.244290, 0.235001, 0.226181, 0.218244, 0.211648, 0.206646, 0.202684, 0.199004, 0.195098, 0.191451, 0.188795, 0.187620, 0.187446, 0.187549, 0.187446, 0.187620, 0.188795, 0.191451, 0.195098, 0.199004, 0.202684, 0.206646, 0.211648, 0.218244, 0.226181, 0.235001, 0.244290, 0.253795, 0.263305, 0.272644, 0.281779, 0.290712, 0.299444, 0.307977, 0.316313, 0.324453, 0.332401, 0.340156, 0.347722, 0.355099, 0.362290, 0.369297, 0.376121, 0.382765, 0.389229, 0.395516, 0.401627, 0.407565, 0.413332, 0.418928, 0.424356, 0.429617, 0.434714, 0.439648, 0.444421, 0.449035, 0.453491, 0.457792, 0.461939, 0.465935, 0.469780, 0.473476, 0.477026, 0.480432, 0.483694, 0.486815, 0.489797, 0.492641, 0.495350, 0.497925, 0.500367, 0.502679, 0.504863, 0.506920, 0.508852, 0.510661, 0.512349, 0.513917, 0.515368, 0.516702, 0.517923, 0.519031, 0.520029, 0.520918, 0.521700, 0.522378, 0.522952, 0.523424, 0.523797, 0.524072, 0.524251, 0.524336, 0.524329, 0.524231, 0.524044, 0.523770, 0.523410, 0.522968, 0.522444, 0.521840, 0.521158, 0.520399, 0.519567, 0.518662, 0.517686, 0.516641, 0.515529, 0.514352, 0.513111, 0.511808, 0.510446, 0.509025, 0.507548, 0.506017, 0.504433, 0.502797, 0.501113, 0.499382, 0.497605, 0.495784, 0.493921, 0.492018, 0.490077, 0.488100, 0.486088, 0.484043, 0.481967, 0.479861, 0.477729, 0.475570, 0.473388, 0.471184, 0.468959, 0.466716, 0.464457, 0.462182, 0.459895, 0.457596, 0.455288, 0.452972, 0.450651, 0.448326, 0.445998, 0.443670, 0.441343, 0.439020, 0.436702, 0.434390, 0.432087, 0.429795, 0.427515, 0.425249, 0.422999, 0.420766, 0.418553, 0.416361, 0.414192, 0.412049, 0.409931, 0.407843, 0.405784, 0.403758, 0.401766, 0.399809, 0.397890, 0.396010, 0.394171, 0.392376, 0.390625, 0.388920, 0.387264, 0.385658, 0.384104, 0.382604, 0.381159, 0.379772, 0.378444, 0.377176, 0.375972, 0.374832, 0.373759, 0.372753, 0.371818, 0.370955, 0.370165, 0.369450, 0.368813, 0.368255, 0.367778, 0.367383, 0.367073, 0.366849, 0.366713},
  A{0.850000, 0.863434, 0.869700, 0.874091, 0.881900, 0.896914, 0.916900, 0.938666, 0.961200, 0.984083, 1.007100, 1.030176, 1.053600, 1.077624, 1.102000, 1.126440, 1.151000, 1.175792, 1.200800, 1.226019, 1.251600, 1.277521, 1.302900, 1.326886, 1.349600, 1.371474, 1.393200, 1.415244, 1.436900, 1.458012, 1.481800, 1.510921, 1.542400, 1.572768, 1.602200, 1.631533, 1.660600, 1.689049, 1.716800, 1.743808, 1.769900, 1.794931, 1.819000, 1.842281, 1.865000, 1.887344, 1.909300, 1.930805, 1.951800, 1.972250, 1.992200, 2.011697, 2.030700, 2.049164, 2.067100, 2.084534, 2.101500, 2.117999, 2.133900, 2.149083, 2.163600, 2.177545, 2.191000, 2.203974, 2.216200, 2.227432, 2.237800, 2.247471, 2.256400, 2.264507, 2.271800, 2.278313, 2.284100, 2.289218, 2.293700, 2.297542, 2.300600, 2.302789, 2.304400, 2.305676, 2.306300, 2.305946, 2.304800, 2.303104, 2.300800, 2.297837, 2.294500, 2.290821, 2.285500, 2.278278, 2.274400, 2.278278, 2.285500, 2.290821, 2.294500, 2.297837, 2.300800, 2.303104, 2.304800, 2.305946, 2.306300, 2.305676, 2.304400, 2.302789, 2.300600, 2.297542, 2.293700, 2.289218, 2.284100, 2.278313, 2.271800, 2.264507, 2.256400, 2.247471, 2.237800, 2.227432, 2.216200, 2.203974, 2.191000, 2.177545, 2.163600, 2.149083, 2.133900, 2.117999, 2.101500, 2.084534, 2.067100, 2.049164, 2.030700, 2.011697, 1.992200, 1.972250, 1.951800, 1.930805, 1.909300, 1.887344, 1.865000, 1.842281, 1.819000, 1.794931, 1.769900, 1.743808, 1.716800, 1.689049, 1.660600, 1.631533, 1.602200, 1.572768, 1.542400, 1.510921, 1.481800, 1.458012, 1.436900, 1.415244, 1.393200, 1.371474, 1.349600, 1.326886, 1.302900, 1.277521, 1.251600, 1.226019, 1.200800, 1.175791, 1.151000, 1.126440, 1.102000, 1.077622, 1.053600, 1.030185, 1.007100, 0.984052, 0.961200, 0.938781, 0.916900, 0.896486, 0.881900, 0.875687, 0.869700, 0.857480, 0.850000, 0.857480, 0.869700, 0.875687, 0.881900, 0.896486, 0.916900, 0.938781, 0.961200, 0.984052, 1.007100, 1.030185, 1.053600, 1.077622, 1.102000, 1.126440, 1.151000, 1.175791, 1.200800, 1.226019, 1.251600, 1.277521, 1.302900, 1.326886, 1.349600, 1.371474, 1.393200, 1.415244, 1.436900, 1.458012, 1.481800, 1.510921, 1.542400, 1.572768, 1.602200, 1.631533, 1.660600, 1.689049, 1.716800, 1.743808, 1.769900, 1.794931, 1.819000, 1.842281, 1.865000, 1.887344, 1.909300, 1.930805, 1.951800, 1.972250, 1.992200, 2.011697, 2.030700, 2.049164, 2.067100, 2.084534, 2.101500, 2.117999, 2.133900, 2.149083, 2.163600, 2.177545, 2.191000, 2.203974, 2.216200, 2.227432, 2.237800, 2.247471, 2.256400, 2.264507, 2.271800, 2.278313, 2.284100, 2.289218, 2.293700, 2.297542, 2.300600, 2.302789, 2.304400, 2.305676, 2.306300, 2.305946, 2.304800, 2.303104, 2.300800, 2.297837, 2.294500, 2.290821, 2.285500, 2.278278, 2.274400, 2.278278, 2.285500, 2.290821, 2.294500, 2.297837, 2.300800, 2.303104, 2.304800, 2.305946, 2.306300, 2.305676, 2.304400, 2.302789, 2.300600, 2.297542, 2.293700, 2.289218, 2.284100, 2.278313, 2.271800, 2.264507, 2.256400, 2.247471, 2.237800, 2.227432, 2.216200, 2.203974, 2.191000, 2.177545, 2.163600, 2.149083, 2.133900, 2.117999, 2.101500, 2.084534, 2.067100, 2.049164, 2.030700, 2.011697, 1.992200, 1.972250, 1.951800, 1.930805, 1.909300, 1.887344, 1.865000, 1.842281, 1.819000, 1.794931, 1.769900, 1.743808, 1.716800, 1.689049, 1.660600, 1.631533, 1.602200, 1.572768, 1.542400, 1.510921, 1.481800, 1.458012, 1.436900, 1.415244, 1.393200, 1.371474, 1.349600, 1.326886, 1.302900, 1.277521, 1.251600, 1.226019, 1.200800, 1.175792, 1.151000, 1.126440, 1.102000, 1.077624, 1.053600, 1.030176, 1.007100, 0.984083, 0.961200, 0.938666, 0.916900, 0.896914, 0.881900, 0.874091, 0.869700, 0.863434}
{

}

unsigned int Drag::calcI(double phi){
  // to degrees
  double phi_deg = phi*180.0/M_PI;

  // wrap
  if(phi_deg > 179){
    phi_deg = phi_deg - 360;
  } else if(phi_deg < -180){
    phi_deg = phi_deg + 360;
  }
  unsigned int i = 180+std::ceil(phi_deg);
  return i;
}

double Drag::getA(double phi){
  unsigned int i = calcI(phi);
  return A[i];
}

double Drag::getCd(double phi){
  unsigned int i = calcI(phi);
  return Cd[i];
}
